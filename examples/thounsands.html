<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script type="text/javascript" src="../dist/js/XIEGlobal.js"></script>


    <style>

    </style>
</head>
<body>
<div  style="line-height:2em;">
    你正在拖动，第
    <span style="display: inline-block" id = 'infoDiv1'></span>
    个
</div>

<div id = 'XIEWrapper' style="background-color: aquamarine;"></div>





<script>






    var infoDiv1 = document.getElementById('infoDiv1');



    if(! XIE){   alert('XIE 没有加载正确');     }

    var stageWidth = 800, stageHeight = 600;
    var stage = new  XIE.Stage({
        wrapper: 'XIEWrapper',
        width: stageWidth,
        height: stageHeight
    });

    function addCircle(attr, layer){
        var  circle = new XIE.Circle({
            x: attr.x,
            y: attr.y,
            radius: 5,
            fill: attr.color,
            id: attr.id,
            draggable: true
        });

        layer.add(circle);
    }


    //data
    var colors = ['red', 'orange', 'cyan', 'green', 'blue', 'purple'], data =[];

    for(var n = 0; n < 3000; n++) {
        var x = Math.random() * stageWidth;
        var y = stageHeight + (Math.random() * 200) - 100 + (stageHeight / stageWidth) * -1 * x;
        data.push({
            x: x,
            y: y,
            id: n,
            color: colors[Math.round(Math.random() * 5)]
        });
    }

    // convert data to XIE Shapes
    //
    var dragLayer = new XIE.Layer();
    var nodeCount = 0;
    var layerNumber = 0;
    var layer = new XIE.Layer();
    //console.time('layer_'+ layerNumber);
    for(var n = 0; n < data.length; n++) {
        addCircle(data[n], layer);
        nodeCount++;
        if(nodeCount >= 300) {

           // console.timeEnd('layer_'+ layerNumber);
            layerNumber ++;
           // console.time('layer_'+ layerNumber);

            nodeCount = 0;
            stage.add(layer);
            layer.draw();
            layer = new XIE.Layer();


        }
    }
  //  console.timeEnd('layer_'+ layerNumber);
    stage.add(dragLayer);

    stage.on('mousedown',function(evt){
        if(evt.target && evt.target instanceof XIE.Shape){
            infoDiv1.innerHTML = ' '+ evt.target.attr.id + ' 号圆圈' ;
            evt.target.parent.remove(evt.target);
            dragLayer.add(evt.target);
        }


    });

    stage.on('mouseup',function(evt){
        if(evt.target && evt.target instanceof XIE.Shape){
            infoDiv1.innerHTML = '' ;
        }

    });

 var kk =0;


</script>


</body>
</html>